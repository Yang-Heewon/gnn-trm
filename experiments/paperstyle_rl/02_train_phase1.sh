#!/usr/bin/env bash
set -euo pipefail

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
source "$SCRIPT_DIR/env.sh"

DATASET="$DATASET" \
MODEL_IMPL="$MODEL_IMPL" \
EPOCHS="$EPOCHS_PHASE1" \
BATCH_SIZE="$BATCH_SIZE" \
LR="$LR" \
MAX_STEPS="$MAX_STEPS" \
CKPT_DIR="$CKPT_DIR_PHASE1" \
TORCHRUN="$TORCHRUN" \
NPROC_PER_NODE="$NPROC_PER_NODE" \
MASTER_PORT="$MASTER_PORT" \
CUDA_VISIBLE_DEVICES="$CUDA_VISIBLE_DEVICES" \
DDP_FIND_UNUSED="$DDP_FIND_UNUSED" \
WANDB_MODE="$WANDB_MODE" \
WANDB_PROJECT="$WANDB_PROJECT" \
WANDB_ENTITY="$WANDB_ENTITY" \
WANDB_RUN_NAME="$WANDB_RUN_NAME_PHASE1" \
bash trm_rag_style/scripts/run_train_phase1_paperstyle_wandb.sh
