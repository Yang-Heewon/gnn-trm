{
  "workspace_root": ".",
  "trm_root": "TinyRecursiveModels",
  "trm_tokenizer": "intfloat/multilingual-e5-large",
  "entity_names_json": "data/data/entities_names.json",
  "emb_tag": "e5",

  "max_steps": 4,
  "max_paths": 4,
  "mine_max_neighbors": 128,
  "train_path_policy": "all",
  "train_shortest_k": 1,
  "train_min_path_hops": 1,
  "preprocess_workers": 0,

  "embed_batch_size": 64,
  "embed_max_length": 128,
  "embed_device": "cuda",
  "embed_gpus": "",
  "embed_style": "gnn_rag",
  "embed_backend": "auto",
  "embed_query_prefix": "query: ",
  "embed_passage_prefix": "passage: ",
  "embed_save_lists": true,

  "batch_size": 8,
  "epochs": 50,
  "lr": 0.0001,
  "num_workers": 4,
  "max_q_len": 512,
  "max_neighbors": 256,
  "prune_keep": 64,
  "prune_rand": 64,
  "beam": 8,
  "start_topk": 5,
  "eval_beam": 8,
  "eval_start_topk": 5,
  "eval_max_steps": 4,
  "eval_max_neighbors": 256,
  "eval_prune_keep": 64,
  "eval_no_cycle": true,
  "eval_use_halt": true,
  "eval_min_hops_before_stop": 2,
  "eval_random_sample_size": 0,
  "eval_random_seed": 42,
  "eval_random_resample_each_eval": false,
  "seed": 42,
  "deterministic": false,
  "eval_pred_topk": 5,
  "eval_limit": 200,
  "debug_eval_n": 5,
  "eval_every_epochs": 1,
  "eval_start_epoch": 1,
  "oracle_diag_enabled": true,
  "oracle_diag_limit": 500,
  "oracle_diag_fail_threshold": -1,
  "oracle_diag_only": false,
  "endpoint_loss_mode": "metric_align_main",
  "relation_aux_weight": 0.2,
  "endpoint_aux_weight": 0.2,
  "metric_align_aux_weight": 0.0,
  "halt_aux_weight": 0.1,
  "phase2_start_epoch": 0,
  "phase2_endpoint_loss_mode": "",
  "phase2_relation_aux_weight": "",
  "phase2_endpoint_aux_weight": "",
  "phase2_metric_align_aux_weight": "",
  "phase2_halt_aux_weight": "",
  "phase2_auto_enabled": false,
  "phase2_auto_metric": "dev_f1",
  "phase2_auto_threshold": "",
  "phase2_auto_patience": 0,
  "phase2_auto_min_epoch": 1,
  "phase2_auto_min_delta": 0.001,
  "phase2_rl_reward_metric": "f1",
  "phase2_rl_entropy_weight": 0.0,
  "phase2_rl_sample_temp": 1.0,
  "phase2_rl_use_greedy_baseline": true,
  "phase2_rl_no_cycle": true,
  "phase2_rl_adv_clip": "",
  "train_acc_mode": "endpoint_proxy",
  "query_residual_enabled": false,
  "query_residual_alpha": 0.0,
  "query_residual_mode": "sub_rel",
  "subgraph_reader_enabled": true,
  "subgraph_hops": 3,
  "subgraph_max_nodes": 2048,
  "subgraph_max_edges": 8192,
  "subgraph_add_reverse_edges": true,
  "subgraph_recursion_steps": 8,
  "subgraph_gnn_variant": "rearev_bfs",
  "subgraph_rearev_num_ins": 3,
  "subgraph_rearev_adapt_stages": 1,
  "subgraph_dropout": 0.1,
  "subgraph_pred_threshold": 0.5,
  "subgraph_pos_weight_mode": "auto",
  "subgraph_pos_weight": 1.0,
  "subgraph_pos_weight_max": 256.0,
  "subgraph_split_reverse_relations": false,
  "subgraph_direction_embedding_enabled": false,
  "subgraph_ranking_enabled": false,
  "subgraph_ranking_weight": 0.0,
  "subgraph_ranking_margin": 0.2,
  "subgraph_hard_negative_topk": 16,
  "subgraph_bce_hard_negative_enabled": false,
  "subgraph_bce_hard_negative_topk": 64,
  "subgraph_lr_scheduler": "none",
  "subgraph_lr_min": 0.0,
  "subgraph_lr_step_size": 5,
  "subgraph_lr_gamma": 0.5,
  "subgraph_lr_plateau_factor": 0.5,
  "subgraph_lr_plateau_patience": 2,
  "subgraph_lr_plateau_threshold": 0.0001,
  "subgraph_lr_plateau_metric": "train_loss",
  "subgraph_resume_epoch": -1,

  "seq_len": 1024,
  "hidden_size": 512,
  "num_heads": 8,
  "expansion": 4.0,
  "H_cycles": 3,
  "L_cycles": 6,
  "L_layers": 2,
  "puzzle_emb_len": 16,
  "pos_encodings": "rope",
  "forward_dtype": "float32",
  "halt_max_steps": 16,
  "halt_exploration_prob": 0.1,
  "ddp_find_unused": true,
  "freeze_lm_head": true,
  "wandb_project": "graph-traverse",
  "wandb_entity": "",
  "wandb_run_name": "",
  "wandb_mode": "online",
  "auto_test_after_train": true
}
